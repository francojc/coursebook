<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Exploration | Text as Data</title>
<meta name="author" content="Jerid Francom">
<meta name="description" content="INCOMPLETE DRAFT  Nobody ever figures out what life is all about, and it doesn’t matter. Explore the world. Nearly everything is really interesting if you go into it deeply enough. – Richard P....">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Chapter 10 Exploration | Text as Data">
<meta property="og:type" content="book">
<meta property="og:url" content="https://lin380.github.io/coursebook/exploration-chapter.html">
<meta property="og:image" content="https://lin380.github.io/coursebook/assets/images/logo.png">
<meta property="og:description" content="INCOMPLETE DRAFT  Nobody ever figures out what life is all about, and it doesn’t matter. Explore the world. Nearly everything is really interesting if you go into it deeply enough. – Richard P....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Exploration | Text as Data">
<meta name="twitter:site" content="@jeridfrancom">
<meta name="twitter:description" content="INCOMPLETE DRAFT  Nobody ever figures out what life is all about, and it doesn’t matter. Explore the world. Nearly everything is really interesting if you go into it deeply enough. – Richard P....">
<meta name="twitter:image" content="https://lin380.github.io/coursebook/assets/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Favicon --><link rel="shortcut icon" href="assets/images/favicon.ico">
<!-- Embed Hypothes.is --><script src="https://hypothes.is/embed.js" async></script><!-- Google Analytics --><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-57189160-3', 'auto');
      ga('send', 'pageview');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="assets/bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="An introduction to quantitative text analysis and reproducible research with R">Text as Data</a>:
        <small class="text-muted">An introduction to quantitative text analysis and reproducible research with R</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li class="book-part">Foundations</li>
<li><a class="" href="foundations-overview.html">Overview</a></li>
<li><a class="" href="text-analysis-chapter.html"><span class="header-section-number">1</span> Text analysis in context</a></li>
<li class="book-part">Orientation</li>
<li><a class="" href="orientation-overview.html">Overview</a></li>
<li><a class="" href="understanding-data-chapter.html"><span class="header-section-number">2</span> Understanding data</a></li>
<li><a class="" href="approaching-analysis-chapter.html"><span class="header-section-number">3</span> Approaching analysis</a></li>
<li><a class="" href="framing-research-chapter.html"><span class="header-section-number">4</span> Framing research</a></li>
<li class="book-part">Preparation</li>
<li><a class="" href="preparation-overview.html">Overview</a></li>
<li><a class="" href="acquire-data-chapter.html"><span class="header-section-number">5</span> Acquire data</a></li>
<li><a class="" href="curate-datasets-chapter.html"><span class="header-section-number">6</span> Curate data(sets)</a></li>
<li><a class="" href="transform-datasets-chapter.html"><span class="header-section-number">7</span> Transform datasets</a></li>
<li class="book-part">Analysis</li>
<li><a class="" href="analysis-overview.html">Overview</a></li>
<li><a class="" href="inference-chapter.html"><span class="header-section-number">8</span> Inference</a></li>
<li><a class="" href="prediction-chapter.html"><span class="header-section-number">9</span> Prediction</a></li>
<li><a class="active" href="exploration-chapter.html"><span class="header-section-number">10</span> Exploration</a></li>
<li class="book-part">Communication</li>
<li><a class="" href="communication-overview.html">Overview</a></li>
<li><a class="" href="reporting-chapter.html"><span class="header-section-number">11</span> Reporting</a></li>
<li><a class="" href="collaboration-chapter.html"><span class="header-section-number">12</span> Collaboration</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="appendix-data.html"><span class="header-section-number">A</span> Data</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/lin380/coursebook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="exploration-chapter" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Exploration<a class="anchor" aria-label="anchor" href="#exploration-chapter"><i class="fas fa-link"></i></a>
</h1>
<p style="font-weight:bold; color:red;">
INCOMPLETE DRAFT
</p>
<blockquote>
<p>Nobody ever figures out what life is all about, and it doesn’t matter. Explore the world. Nearly everything is really interesting if you go into it deeply enough.</p>
<p>– Richard P. Feynman</p>
</blockquote>
<div class="rmdkey">
<p>
The essential questions for this chapter are:
</p>
<ul>
<li>
…
</li>
</ul>
</div>
<!-- COURSE STRUCTURE

TUTORIALS:

- ...

SWIRL:

- ...

WORKED/ RECIPE:

- ...

PROJECT:

- ...

GOALS:

...

-->
<p>In this chapter….</p>
<ul>
<li><p>identify, interrogate, and interpret</p></li>
<li><p>EDA is an inductive approach. That is, it is bottom-up –we do not come into the analysis with strong preconceptions of what the data will tell us (IDA - hypothesis and PDA - target classes). The aim is to uncover and discover patterns that lead to insight based on qualitative interpretation. EDA, the, can be considered a quantitative-supported qualitative analysis.</p></li>
<li>
<p>Two main classes of exploratory data analysis: (1) descriptive analysis and (2) unsupervised machine learning.</p>
<ul>
<li>descriptive analysis can be seen as a more detailed implementation of descriptive assessment, which is a key component of both inferential and predictive analysis approaches. .</li>
<li>unsupervised machine learning is a more algorithmic approach to deriving knowledge which leverages … to produce knowledge which can be interpreted. This approach falls under the umbrella of machine learning, as we have seen in predictive data analysis, however, whereas PDA assumes a potential relationship between input features and target outcomes, or classes, in unsupervised learning the classes are induced from the data itself and the classes groupings are interpreted and evaluated more …?</li>
</ul>
</li>
<li><p>It is, however, important to come to EDA with a research question in which the unit of analysis is clear.</p></li>
</ul>
<p>Description of the datasets we will use to examine various exploratory methods.</p>
<p><strong>Lastfm</strong></p>
<p>Last.fm webscrape of the top artists by genre which we acquired in Chapter 5 <a href="#acquire-data">“Acquire data”</a> in the <a href="acquire-data.html#scaling-up">web scrape section</a> and transformed in Chapter 6 <a href="transform-data.html#normalize">“Transform data”</a>.</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">lastfm_df</span><span class="op">)</span>  <span class="co"># preview dataset structure</span>
<span class="co">#&gt; Rows: 200</span>
<span class="co">#&gt; Columns: 4</span>
<span class="co">#&gt; $ artist &lt;chr&gt; "Alan Jackson", "Alan Jackson", "Brad Paisley", "Carrie Underwo…</span>
<span class="co">#&gt; $ song   &lt;chr&gt; "Little Bitty", "Remember When", "Mud on the Tires", "Before He…</span>
<span class="co">#&gt; $ lyrics &lt;chr&gt; "Have a little love on a little honeymoon You got a little dish…</span>
<span class="co">#&gt; $ genre  &lt;chr&gt; "country", "country", "country", "country", "country", "country…</span></code></pre></div>
<p>The <code>lastfm_df</code> dataset contains 155 observations and 4 variables. Each observation corresponds to a particular song.</p>
<p>Let’s look at the data dictionary for this dataset.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:eda-lastfm-data-dictionary-preview">Table 10.1: </span>Last.fm lyrics dataset data dictionary.</caption>
<thead><tr class="header">
<th align="left">variable_name</th>
<th align="left">name</th>
<th align="left">description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">artist</td>
<td align="left">Artist Name</td>
<td align="left">The name of the artist</td>
</tr>
<tr class="even">
<td align="left">song</td>
<td align="left">Song Title</td>
<td align="left">The title of the song</td>
</tr>
<tr class="odd">
<td align="left">lyrics</td>
<td align="left">Song Lyrics</td>
<td align="left">The lyrics for the song</td>
</tr>
<tr class="even">
<td align="left">genre</td>
<td align="left">Song Genre</td>
<td align="left">The genre of the artist (source last.fm)</td>
</tr>
</tbody>
</table></div>
<p>From the data dictionary we see that each song encodes the artist, the song title, the genre of the song, and the lyrics for the song.</p>
<p>To prepare for the upcoming exploration methods, we will convert the <code>lastfm_df</code> to a Quanteda corpus object.</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create corpus object</span>
<span class="va">lastfm_corpus</span> <span class="op">&lt;-</span> 
  <span class="va">lastfm_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># data frame</span>
  <span class="fu">corpus</span><span class="op">(</span>text_field <span class="op">=</span> <span class="st">"lyrics"</span><span class="op">)</span> <span class="co"># create corpus</span>

<span class="va">lastfm_corpus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># preview</span>
<span class="co">#&gt; Corpus consisting of 155 documents, showing 5 documents:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Text Types Tokens Sentences           artist                song   genre</span>
<span class="co">#&gt;  text1    84    271         1     Alan Jackson        Little Bitty country</span>
<span class="co">#&gt;  text2   110    203         1     Alan Jackson       Remember When country</span>
<span class="co">#&gt;  text3   130    290         2     Brad Paisley    Mud on the Tires country</span>
<span class="co">#&gt;  text4   114    303         1 Carrie Underwood    Before He Cheats country</span>
<span class="co">#&gt;  text5   171    517        15   Dierks Bentley What Was I Thinkin' country</span></code></pre></div>
<p><strong>SOTU</strong></p>
<p>The quanteda package <span class="citation">(<a href="references.html#ref-R-quanteda" role="doc-biblioref">Benoit et al., 2022</a>)</span> includes various datasets. We will work with the State of the Union Corpus <span class="citation">(<a href="references.html#ref-R-quanteda.corpora" role="doc-biblioref">Benoit, 2020</a>)</span>. Let’s take a look at the structure of this dataset.</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">sotu_df</span><span class="op">)</span>  <span class="co"># preview dataset structure</span>
<span class="co">#&gt; Rows: 84</span>
<span class="co">#&gt; Columns: 5</span>
<span class="co">#&gt; $ president &lt;chr&gt; "Truman", "Truman", "Truman", "Truman", "Truman", "Truman", …</span>
<span class="co">#&gt; $ delivery  &lt;fct&gt; written, spoken, spoken, spoken, spoken, spoken, spoken, wri…</span>
<span class="co">#&gt; $ party     &lt;fct&gt; Democratic, Democratic, Democratic, Democratic, Democratic, …</span>
<span class="co">#&gt; $ year      &lt;dbl&gt; 1946, 1947, 1948, 1949, 1950, 1951, 1952, 1953, 1953, 1954, …</span>
<span class="co">#&gt; $ text      &lt;chr&gt; "To the Congress of the United States:\n\nA quarter century …</span></code></pre></div>
<p>In the <code>sotu_df</code> dataset there are 84 observations and 5 variables. Each observation corresponds to a presidential address.</p>
<p>Let’s look at the data dictionary to understand what each column measures.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:eda-sotu-data-dictionary-preview">Table 10.2: </span>SOTU dataset data dictionary.</caption>
<colgroup>
<col width="17%">
<col width="26%">
<col width="55%">
</colgroup>
<thead><tr class="header">
<th align="left">variable_name</th>
<th align="left">name</th>
<th align="left">description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">president</td>
<td align="left">President</td>
<td align="left">Incumbent president</td>
</tr>
<tr class="even">
<td align="left">delivery</td>
<td align="left">Modality of delivery</td>
<td align="left">Modality of the address (spoken or written)</td>
</tr>
<tr class="odd">
<td align="left">party</td>
<td align="left">Political party</td>
<td align="left">Party affliliation of the president</td>
</tr>
<tr class="even">
<td align="left">year</td>
<td align="left">Year</td>
<td align="left">Year that the statement was given</td>
</tr>
<tr class="odd">
<td align="left">text</td>
<td align="left">Text</td>
<td align="left">Text or transcription of the address</td>
</tr>
</tbody>
</table></div>
<p>So we see that each observation corresponds to the president that gave the address, the modality of the address, the party the president was affliated with, the year that the address was given, and the address text.</p>
<div id="descriptive-analysis" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Descriptive analysis<a class="anchor" aria-label="anchor" href="#descriptive-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>… overview summary of the aims of descriptive analysis methods…</p>
<div id="frequency-analysis" class="section level3" number="10.1.1">
<h3>
<span class="header-section-number">10.1.1</span> Frequency analysis<a class="anchor" aria-label="anchor" href="#frequency-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>Explore word frequency.</p>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create tokens object</span>
<span class="va">lastfm_tokens</span> <span class="op">&lt;-</span> 
  <span class="va">lastfm_corpus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># corpus object</span>
  <span class="fu">tokens</span><span class="op">(</span>what <span class="op">=</span> <span class="st">"word"</span>, <span class="co"># tokenize by word</span>
         remove_punct <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># remove punctuation</span>
  <span class="fu">tokens_tolower</span><span class="op">(</span><span class="op">)</span> <span class="co"># lowercase tokens</span>

<span class="va">lastfm_tokens</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># preview one tokenized document</span>
<span class="co">#&gt; Tokens consisting of 1 document and 3 docvars.</span>
<span class="co">#&gt; text1 :</span>
<span class="co">#&gt;  [1] "have"      "a"         "little"    "love"      "on"        "a"        </span>
<span class="co">#&gt;  [7] "little"    "honeymoon" "you"       "got"       "a"         "little"   </span>
<span class="co">#&gt; [ ... and 252 more ]</span></code></pre></div>
<p>We see the tokenized output.</p>
<p>Many of the frequency analysis function provided with quanteda require that the dataset be in a document-frequency matrix. So let’s create a dfm of the <code>lastfm_corpus</code> object using the <code>dfm()</code> function.</p>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create document-frequency matrix</span>
<span class="va">lastfm_dfm</span> <span class="op">&lt;-</span> 
  <span class="va">lastfm_tokens</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># tokens object</span>
  <span class="fu">dfm</span><span class="op">(</span><span class="op">)</span> <span class="co"># create dfm</span>

<span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># preview 5 documents</span>
<span class="co">#&gt; Document-feature matrix of: 5 documents, 3,966 features (97.19% sparse) and 3 docvars.</span>
<span class="co">#&gt;        features</span>
<span class="co">#&gt; docs    have  a little love on honeymoon you got dish and</span>
<span class="co">#&gt;   text1    1 35     34    1  5         1   4   3    1  10</span>
<span class="co">#&gt;   text2    0  1      1    3  0         0   3   0    0  12</span>
<span class="co">#&gt;   text3    1 21     11    0  9         0   6   5    0   6</span>
<span class="co">#&gt;   text4    1 10      5    0  3         0   1   0    0   4</span>
<span class="co">#&gt;   text5    0 22      7    0  2         0   0   1    0   5</span>
<span class="co">#&gt; [ reached max_nfeat ... 3,956 more features ]</span></code></pre></div>
<p>Frequency distributions.</p>
<ul>
<li>Very few high frequency terms and many low frequency.</li>
<li>This results in a long tail when plotted.</li>
</ul>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Let’s take a closer look at the 50 most frequent word terms in <code>lastfm_dfm</code>. We use the <code>textstat_frequency()</code> function from the quanteda.textstats package to extract various frequency measures.</p>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">textstat_frequency</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;    feature frequency rank docfreq group</span>
<span class="co">#&gt; 1        i      2048    1     148   all</span>
<span class="co">#&gt; 2      you      2045    2     139   all</span>
<span class="co">#&gt; 3      the      1787    3     148   all</span>
<span class="co">#&gt; 4      and      1242    4     151   all</span>
<span class="co">#&gt; 5        a      1067    5     135   all</span>
<span class="co">#&gt; 6       to       933    6     147   all</span>
<span class="co">#&gt; 7       me       883    7     132   all</span>
<span class="co">#&gt; 8       my       768    8     116   all</span>
<span class="co">#&gt; 9       it       666    9     118   all</span>
<span class="co">#&gt; 10      in       597   10     131   all</span></code></pre></div>
<p>We can then use this data frame to plot the frequency of the terms in descending order using <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">textstat_frequency</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">feature</span>, <span class="va">frequency</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">frequency</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Words"</span>, y <span class="op">=</span> <span class="st">"Raw frequency"</span>, title <span class="op">=</span> <span class="st">"Top 50"</span><span class="op">)</span></code></pre></div>
<p><img src="11-exploration_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;">
Now these are the most common terms for all of the song lyrics. In our case, let’s look at the most common 15 terms for each of the genres. We will need at a <code>groups =</code> argument to <code>textstat_frequency()</code> to get the <code>genre</code> and then we need to manipulate the data frame output and the extract the top 15 terms grouping by <code>genre</code>.</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># dfm</span>
  <span class="fu">textstat_frequency</span><span class="op">(</span>groups <span class="op">=</span> <span class="va">genre</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># get frequency statistics</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># grouping parameters</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">frequency</span>, n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># extract top features</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># remove grouping parameters</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">frequency</span>, y <span class="op">=</span> <span class="fu">reorder_within</span><span class="op">(</span><span class="va">feature</span>, <span class="va">frequency</span>, <span class="va">group</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># mappings (reordering feature by frequency)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="co"># bar plot</span>
  <span class="fu">scale_y_reordered</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># clean up y-axis labels (features)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">group</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># organize separate plots by genre</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Raw frequency"</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># labels</span></code></pre></div>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="rmdtip">
<p>
Note that I’ve used the plotting function <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> to tell ggplot2 to organize each of the genres in separate bar plots but in the same plotting space. The <code>scales =</code> argument takes either <code>free</code>, <code>free_x</code>, or <code>free_y</code> as a value. This will let the all the axes or either the x- or y-axis vary freely between the separate plots.
</p>
</div>
<p>Raw frequency is effected by the total number of words in each genre. Therefore we cannot safely make direct comparisons between the frequency counts for individual terms between genres.</p>
<p>To make the term-genre comparisons comparable we normalized the term frequency by the number of terms in each genre. We can use the <code>dfm_weight()</code> function with the argument <code>scheme = "prop"</code> to give us the relative frequency of a term per the number of terms in the document it appears in. This weighting is known as Term frequency.</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># dfm</span>
  <span class="fu">dfm_weight</span><span class="op">(</span>scheme <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># weigh by term frequency</span>
  <span class="fu">textstat_frequency</span><span class="op">(</span>groups <span class="op">=</span> <span class="va">genre</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># get frequency statistics</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># grouping parameters</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">frequency</span>, n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># extract top features</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># remove grouping parameters</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">frequency</span>, y <span class="op">=</span> <span class="fu">reorder_within</span><span class="op">(</span><span class="va">feature</span>, <span class="va">frequency</span>, <span class="va">group</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># mappings (reordering feature by frequency)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="co"># bar plot</span>
  <span class="fu">scale_y_reordered</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># clean up y-axis labels (features)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">group</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># organize separate plots by genre</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Term frequency"</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># labels</span></code></pre></div>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Term frequency makes the frequency scores relative to the genre. This means that the frequencies are directly comparable as the number of words in each genre is taken into account when calculating the term frequency score.</p>
<p>Now our term frequency measures allow us to make direct comparisons, but one problem here is that the most frequent terms tend to be terms that are common across all language use. Since the aim of most frequency analyses which compare sub-groups is to discover what terms are most indicative of each sub-group we need a way to adjust or weigh our measures. The scheme often applied to scale terms according to how common they are is to apply term frequency-inverse document frequency (tf-idf). The tf-idf measure is the result of multiplying the term frequency by the inverse document frequency.</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># data frame</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">genre</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># get number of documents for each genre</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>Genre <span class="op">=</span> <span class="va">genre</span>, `Number of documents` <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span>,
               caption <span class="op">=</span> <span class="st">"Number of documents per genre."</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:unnamed-chunk-12">Table 10.3: </span>Number of documents per genre.</caption>
<thead><tr class="header">
<th align="left">Genre</th>
<th align="right">Number of documents</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">country</td>
<td align="right">44</td>
</tr>
<tr class="even">
<td align="left">hip-hop</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="left">pop</td>
<td align="right">41</td>
</tr>
<tr class="even">
<td align="left">rock</td>
<td align="right">44</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dfm_weight</span><span class="op">(</span>scheme <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># term-frequency weight</span>
  <span class="fu">textstat_frequency</span><span class="op">(</span>groups <span class="op">=</span> <span class="va">genre</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># include genre as a group</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">feature</span> <span class="op">==</span> <span class="st">"i"</span><span class="op">)</span> <span class="co"># filter only "i"</span>
<span class="co">#&gt;      feature frequency rank docfreq   group</span>
<span class="co">#&gt; 1          i      1.86    1      42 country</span>
<span class="co">#&gt; 1639       i      1.00    1      26 hip-hop</span>
<span class="co">#&gt; 3600       i      1.64    2      38     pop</span>
<span class="co">#&gt; 5012       i      2.08    1      42    rock</span></code></pre></div>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Manually calculate TF-IDF scores</span>
<span class="fl">1.86</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fl">44</span><span class="op">/</span><span class="fl">42</span><span class="op">)</span>  <span class="co"># i in country</span>
<span class="co">#&gt; [1] 0.0376</span>
<span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fl">26</span><span class="op">/</span><span class="fl">26</span><span class="op">)</span>  <span class="co"># i in hip hop</span>
<span class="co">#&gt; [1] 0</span>
<span class="fl">1.64</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fl">41</span><span class="op">/</span><span class="fl">38</span><span class="op">)</span>  <span class="co"># i in pop</span>
<span class="co">#&gt; [1] 0.0541</span>
<span class="fl">2.08</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fl">44</span><span class="op">/</span><span class="fl">42</span><span class="op">)</span>  <span class="co"># i in rock</span>
<span class="co">#&gt; [1] 0.042</span></code></pre></div>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">dfm_tfidf</span><span class="op">(</span>scheme_tf <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">textstat_frequency</span><span class="op">(</span>groups <span class="op">=</span> <span class="va">genre</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">feature</span>, <span class="st">"^(i|yeah)$"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">feature</span><span class="op">)</span>
<span class="co">#&gt;      feature frequency rank docfreq   group</span>
<span class="co">#&gt; 213        i    0.0373  213      42 country</span>
<span class="co">#&gt; 1873       i    0.0201  235      26 hip-hop</span>
<span class="co">#&gt; 3842       i    0.0329  244      38     pop</span>
<span class="co">#&gt; 5197       i    0.0417  186      42    rock</span>
<span class="co">#&gt; 239     yeah    0.0350  239       8 country</span>
<span class="co">#&gt; 1742    yeah    0.0336  104      14 hip-hop</span>
<span class="co">#&gt; 3755    yeah    0.0454  157      13     pop</span>
<span class="co">#&gt; 5013    yeah    0.2165    2      17    rock</span></code></pre></div>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># dfm</span>
  <span class="fu">dfm_tfidf</span><span class="op">(</span>scheme_tf <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># weigh by tf-idf</span>
  <span class="fu">textstat_frequency</span><span class="op">(</span>groups <span class="op">=</span> <span class="va">genre</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># get frequency statistics</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># grouping parameters</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">frequency</span>, n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># extract top features</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># remove grouping parameters</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">frequency</span>, y <span class="op">=</span> <span class="fu">reorder_within</span><span class="op">(</span><span class="va">feature</span>, <span class="va">frequency</span>, <span class="va">group</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># mappings (reordering feature by frequency)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="co"># bar plot</span>
  <span class="fu">scale_y_reordered</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># clean up y-axis labels (features)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">group</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># organize separate plots by genre</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"TF-IDF"</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># labels</span></code></pre></div>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>TF-IDF works well to identify terms which are particularly indicative of a particular group but there is a shortcoming which is particularly salient when working with song lyrics. That is, that there are terms which are frequent but not common because they appear in one song and are repeated. This is common in song lyrics which tend to have repeated chorus sections. To minimize this influence, we can trim the document-frequency matrix and eliminate terms which only appear in one song.</p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># dfm</span>
  <span class="fu">dfm_trim</span><span class="op">(</span>min_docfreq <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># keep terms appearing in 2 or more songs</span>
  <span class="fu">dfm_tfidf</span><span class="op">(</span>scheme_tf <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># weigh by tf-idf</span>
  <span class="fu">textstat_frequency</span><span class="op">(</span>groups <span class="op">=</span> <span class="va">genre</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># get frequency statistics</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># grouping parameters</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">frequency</span>, n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># extract top features</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># remove grouping parameters</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">frequency</span>, y <span class="op">=</span> <span class="fu">reorder_within</span><span class="op">(</span><span class="va">feature</span>, <span class="va">frequency</span>, <span class="va">group</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># mappings (reordering feature by frequency)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="co"># bar plot</span>
  <span class="fu">scale_y_reordered</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># clean up y-axis labels (features)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">group</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># organize separate plots by genre</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"TF-IDF"</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># labels</span></code></pre></div>
<div class="inline-figure">
<img src="11-exploration_files/figure-html/unnamed-chunk-17-1.png" width="90%" style="display: block; margin: auto;">
Now we are looking a terms which are indicative of their respective genres and appear in at least 2 songs.</div>
<p>Another exploration method is to look at relative frequency, or keyness, measures. This type of analysis compares the relative frequency of terms of a target group in comparison to a reference group. If we set the target to one of our genres then the other genres become the reference. The results show which terms occur significantly more often than they occur in the reference group(s). The <code>textstat_keyness()</code> function implements this type of analysis in quanteda.</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_keywords_country</span> <span class="op">&lt;-</span> 
  <span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># dfm</span>
  <span class="fu">dfm_trim</span><span class="op">(</span>min_docfreq <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># keep terms appearing in 2 or more songs</span>
  <span class="fu">textstat_keyness</span><span class="op">(</span>target <span class="op">=</span> <span class="va">lastfm_dfm</span><span class="op">$</span><span class="va">genre</span> <span class="op">==</span> <span class="st">"country"</span><span class="op">)</span> <span class="co"># compare country</span>

<span class="va">lastfm_keywords_country</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># preview</span>
<span class="co">#&gt;    feature  chi2        p n_target n_reference</span>
<span class="co">#&gt; 1   little 113.3 0.00e+00       77          43</span>
<span class="co">#&gt; 2   belong  45.6 1.46e-11       19           4</span>
<span class="co">#&gt; 3     ring  45.2 1.80e-11       22           7</span>
<span class="co">#&gt; 4     he's  43.3 4.82e-11       25          11</span>
<span class="co">#&gt; 5     went  43.2 4.90e-11       17           2</span>
<span class="co">#&gt; 6     fire  42.2 8.24e-11       21           7</span>
<span class="co">#&gt; 7    blues  42.2 8.44e-11       14           0</span>
<span class="co">#&gt; 8      him  40.9 1.60e-10       34          24</span>
<span class="co">#&gt; 9  country  38.8 4.58e-10       13           0</span>
<span class="co">#&gt; 10    road  37.7 8.11e-10       23          11</span></code></pre></div>
<p>The output of the <code>textstat_keyness()</code> function all terms from most frequent in the target group to the most frequent in the reference group(s). The <code>textplot_keyness()</code> takes advantage of this and we can see the most contrastive terms in a plot.</p>
<p>Let’s look at what terms are most and least indicative of the ‘country’ genre.</p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_keywords_country</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">textplot_keyness</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, labelsize <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="co"># plot most contrastive terms</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Chi-squared statistic"</span>, 
       title <span class="op">=</span> <span class="st">"Term keyness"</span>, 
       subtitle <span class="op">=</span> <span class="st">"Country versus other genres"</span><span class="op">)</span> <span class="co"># labels</span></code></pre></div>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Interpretation….</p>
<p>Now let’s look at the ‘Hip hop’ genre.</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># dfm</span>
  <span class="fu">dfm_trim</span><span class="op">(</span>min_docfreq <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># keep terms appearing in 2 or more songs</span>
  <span class="fu">textstat_keyness</span><span class="op">(</span>target <span class="op">=</span> <span class="va">lastfm_dfm</span><span class="op">$</span><span class="va">genre</span> <span class="op">==</span> <span class="st">"hip-hop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># compare hip hop</span>
  <span class="fu">textplot_keyness</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, labelsize <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="co"># plot most contrastive terms</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Chi-squared statistic"</span>,
      title <span class="op">=</span> <span class="st">"Term keyness"</span>, 
       subtitle <span class="op">=</span> <span class="st">"Hip hop versus other genres"</span><span class="op">)</span> <span class="co"># labels</span></code></pre></div>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-20-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Interpretation …</p>
<p>Now we have been working with words as our tokens/ features but a word is simply a unigram token. We can also consider multi-word tokens, or ngrams. To create bigrams (2-word tokens) we return to the <code>lastfm_tokens</code> object and add the function <code>tokens_ngrams()</code> with the argument <code>n = 2</code> (for bigrams). Then just as before we create a DFM object. I will go ahead and trim the DFM to exclude terms appearing only in one document (i.e. song).</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tokenize by bigrams</span>
<span class="va">lastfm_dfm_ngrams</span> <span class="op">&lt;-</span> 
  <span class="va">lastfm_tokens</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># word tokens</span>
  <span class="fu">tokens_ngrams</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># create 2-term ngrams (bigrams)</span>
  <span class="fu">dfm</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># create document-frequency matrix</span>
  <span class="fu">dfm_trim</span><span class="op">(</span>min_docfreq <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># keep terms appearing in 2 or more songs</span>

<span class="va">lastfm_dfm_ngrams</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># preview 1 document</span>
<span class="co">#&gt; Document-feature matrix of: 1 document, 3,232 features (98.73% sparse) and 3 docvars.</span>
<span class="co">#&gt;        features</span>
<span class="co">#&gt; docs    have_a a_little on_a you_got got_a and_you and_a well_it's it's_alright</span>
<span class="co">#&gt;   text1      1       25    1       3     3       1     7         2            4</span>
<span class="co">#&gt;        features</span>
<span class="co">#&gt; docs    to_be</span>
<span class="co">#&gt;   text1     4</span>
<span class="co">#&gt; [ reached max_nfeat ... 3,222 more features ]</span></code></pre></div>
<p>Interpretation …</p>
<p>We can now repeat the same steps we did earlier to explore raw frequency, term frequency, and tf-idf frequency measures by genre. We will skip the visualization of raw frequency as it is inherently incompatible with direct comparisons between sub-groups.</p>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-22-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Interpretation …</p>
<p>We can even pull out particular terms and explore them directly.</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Term frequency comparison</span>
<span class="va">lastfm_dfm_ngrams</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">dfm_weight</span><span class="op">(</span>scheme <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">textstat_frequency</span><span class="op">(</span>groups <span class="op">=</span> <span class="va">genre</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">feature</span>, <span class="st">"i_ain't"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;      feature frequency rank docfreq   group</span>
<span class="co">#&gt; 45   i_ain't     0.110   45       4 country</span>
<span class="co">#&gt; 1944 i_ain't     0.109   15       8 hip-hop</span>
<span class="co">#&gt; 3733 i_ain't     0.109   54       3     pop</span></code></pre></div>
<p>Interpretation …</p>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-24-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-25-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Before we leave this introduction to frequency analysis, let’s consider another type of metric which can be used to explore term usage in and across documents which aims to estimate lexical diversity, the number of unique terms (types) to the total number of terms (tokens). This is known as the Type-Token Ratio (TTR). The TTR measure is biased when comparison documents or groups differ in the number of total tokens. To mitigate this issue the Moving-Average Type-Token Ratio (MATTR) is often used. MATTR the moving window size must be set to a reasonable size given the size of the documents. In this case we will use 50 as all the lyrics in the datasset have at least this number of words.</p>
<p>I will use box plots to visualize the distribution of the TTR and MATTR estimates across the four genres.</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_lexdiv</span> <span class="op">&lt;-</span> <span class="va">lastfm_tokens</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">textstat_lexdiv</span><span class="op">(</span>measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TTR"</span>, <span class="st">"MATTR"</span><span class="op">)</span>, MATTR_window <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>

<span class="va">lastfm_docvars</span> <span class="op">&lt;-</span> <span class="va">lastfm_tokens</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">docvars</span><span class="op">(</span><span class="op">)</span>

<span class="va">lastfm_lexdiv_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">lastfm_docvars</span>, <span class="va">lastfm_lexdiv</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">lastfm_lexdiv_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">genre</span>, <span class="va">TTR</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">TTR</span>, color <span class="op">=</span> <span class="va">genre</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>notch <span class="op">=</span> <span class="cn">TRUE</span>,
    show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Genre"</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">lastfm_lexdiv_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">genre</span>, <span class="va">MATTR</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">MATTR</span>, color <span class="op">=</span> <span class="va">genre</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>notch <span class="op">=</span> <span class="cn">TRUE</span>,
    show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Genre"</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></code></pre></div>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-26-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>We can see that there are similarities and differences between the two estimates of lexical diversity. In both cases, there is a trend towards ‘country’ being the most diverse and ‘pop’ the least diverse. ‘rock’ and ‘hip-hop’ are swapped given the estimate type. It is important, however, to note that the notches in the box plot provide us a rough guide to gauge whether these trends are statistically significant or not. Focusing on the more reliable MATTR and using the notches as our guide, it looks like we can safely say that ‘country’ is more lexically diverse than the other genres. Another potential take-home message is that pop appears to be the most internally variable –that is, there appears to be quite a bit of variability between the lexical diversity in songs in this genre.</p>
</div>
<div id="collocation-analysis" class="section level3" number="10.1.2">
<h3>
<span class="header-section-number">10.1.2</span> Collocation analysis<a class="anchor" aria-label="anchor" href="#collocation-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>Where frequency analysis focuses on the usage of terms, collocation analysis focuses on the usage of terms in context.</p>
<ul>
<li>Keyword in Context
<ul>
<li><code>kwic()</code></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_tokens</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">tokens_group</span><span class="op">(</span>groups <span class="op">=</span> <span class="va">genre</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">kwic</span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"ain't"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; Keyword-in-context with 10 matches.                                                        </span>
<span class="co">#&gt;   [country, 4468]       to find another for it | ain't |</span>
<span class="co">#&gt;   [hip-hop, 6158]         i got lyrics but you | ain't |</span>
<span class="co">#&gt;     [hip-hop, 66]         i'm into havin sex i | ain't |</span>
<span class="co">#&gt;       [pop, 3060]     happen like that cause i | ain't |</span>
<span class="co">#&gt;    [hip-hop, 336]         i'm into havin sex i | ain't |</span>
<span class="co">#&gt;   [country, 9027]            no pool no pets i | ain't |</span>
<span class="co">#&gt;   [hip-hop, 9996]     in his cage the audience | ain't |</span>
<span class="co">#&gt;  [hip-hop, 10005]     ain't gone clap and they | ain't |</span>
<span class="co">#&gt;    [hip-hop, 378]         i'm into havin sex i | ain't |</span>
<span class="co">#&gt;   [hip-hop, 5398] maybe we're crazy probably i | ain't |</span>
<span class="co">#&gt;                                  </span>
<span class="co">#&gt;  right that she should live      </span>
<span class="co">#&gt;  got none if you come            </span>
<span class="co">#&gt;  into makin love so come         </span>
<span class="co">#&gt;  no hollaback girl i ain't       </span>
<span class="co">#&gt;  into makin love so come         </span>
<span class="co">#&gt;  got no cigarettes ah but        </span>
<span class="co">#&gt;  fazed and they ain't gone       </span>
<span class="co">#&gt;  gone praise they want everything</span>
<span class="co">#&gt;  into makin love so come         </span>
<span class="co">#&gt;  happy i'm feeling glad i</span></code></pre></div>
<p>You can also search for multiword expressions using <code>phrase()</code>. You can use a pattern matching convention to make your key term searches more (‘glob’ and ‘regex’) or less (‘fixed’) flexible.</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_tokens</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">tokens_group</span><span class="op">(</span>groups <span class="op">=</span> <span class="va">genre</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">kwic</span><span class="op">(</span>pattern <span class="op">=</span> <span class="fu">phrase</span><span class="op">(</span><span class="st">"ain't no*"</span><span class="op">)</span>, valuetype <span class="op">=</span> <span class="st">"glob"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; Keyword-in-context with 10 matches.                                                                        </span>
<span class="co">#&gt;    [hip-hop, 171:172]        they wanna fuck but homie | ain't nothing |</span>
<span class="co">#&gt;  [hip-hop, 3345:3346]        streets it's the d-r-e it | ain't nothing |</span>
<span class="co">#&gt;      [pop, 3451:3452]         happen like that cause i |   ain't no    |</span>
<span class="co">#&gt;      [pop, 3065:3066]        ain't no hollaback girl i |   ain't no    |</span>
<span class="co">#&gt;    [pop, 10320:10321] is thriller thriller night there |   ain't no    |</span>
<span class="co">#&gt;      [pop, 3231:3232]        ain't no hollaback girl i |   ain't no    |</span>
<span class="co">#&gt;      [pop, 3060:3061]         happen like that cause i |   ain't no    |</span>
<span class="co">#&gt;  [country, 2758:2759]            i'm a redneck woman i |   ain't no    |</span>
<span class="co">#&gt;      [pop, 3368:3369]         happen like that cause i |   ain't no    |</span>
<span class="co">#&gt;      [pop, 3373:3374]        ain't no hollaback girl i |   ain't no    |</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt;  change hoes down g's up        </span>
<span class="co">#&gt;  but more hot shit another      </span>
<span class="co">#&gt;  hollaback girl i ain't no      </span>
<span class="co">#&gt;  hollaback girl a few times     </span>
<span class="co">#&gt;  second chance against the thing</span>
<span class="co">#&gt;  hollaback girl ooh ooh this    </span>
<span class="co">#&gt;  hollaback girl i ain't no      </span>
<span class="co">#&gt;  high class broad i'm just      </span>
<span class="co">#&gt;  hollaback girl i ain't no      </span>
<span class="co">#&gt;  hollaback girl ooh ooh this</span></code></pre></div>
<ul>
<li>Collocation analysis</li>
</ul>
<p>The frequency analysis of ngrams as terms is similar to but distinct from a collocation analysis. In a collocation analysis the frequency with which a two or more terms co-occur is balanced by the frequency of the terms when they do not cooccur. In other words, the sequences occur more than one would expect given the frequency of the individual terms. This provides an estimate of the tendency of a sequence of words to form a cohesive semantic or syntactic unit.</p>
<p>We can apply the <code>textstat_collocations()</code> function on a tokens object (<code>lastfm_tokens</code>) and retrieve the most cohesive collocations (using the <span class="math inline">\(z\)</span>-statistic) for the entire dataset.</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_tokens</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">textstat_collocations</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt;   collocation count count_nested length lambda    z</span>
<span class="co">#&gt; 1      in the   227            0      2   2.95 33.4</span>
<span class="co">#&gt; 2   yeah yeah    86            0      2   5.32 33.4</span>
<span class="co">#&gt; 3   jump jump    64            0      2   8.44 28.0</span>
<span class="co">#&gt; 4       oh oh    59            0      2   4.78 27.8</span>
<span class="co">#&gt; 5     bum bum    44            0      2   7.48 26.7</span></code></pre></div>
<p>Add a minimum frequency count (<code>min_count =</code>) to avoid hapaxes (terms which happen infrequently yet when they do occur, the cooccur with another specific term which also occurs infrequently). We can also specify the size of the collocation (the default is 2). If we set it to 3 then we will get three-word collocations.</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_tokens</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">textstat_collocations</span><span class="op">(</span>min_count <span class="op">=</span> <span class="fl">50</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;    collocation count count_nested length lambda    z</span>
<span class="co">#&gt; 1       in the   227            0      2   2.95 33.4</span>
<span class="co">#&gt; 2    yeah yeah    86            0      2   5.32 33.4</span>
<span class="co">#&gt; 3    jump jump    64            0      2   8.44 28.0</span>
<span class="co">#&gt; 4        oh oh    59            0      2   4.78 27.8</span>
<span class="co">#&gt; 5        la la    59            0      2   9.13 25.5</span>
<span class="co">#&gt; 6      i'm not    64            0      2   3.95 25.0</span>
<span class="co">#&gt; 7     a little    76            0      2   4.45 23.3</span>
<span class="co">#&gt; 8      i don't   140            0      2   2.40 23.1</span>
<span class="co">#&gt; 9       on the   131            0      2   2.29 22.0</span>
<span class="co">#&gt; 10      like a    81            0      2   2.82 21.4</span></code></pre></div>
<p>If we want to explore the collocations for a specific group in our dataset, we can use the <code>tokens_subset()</code> function and specify the group that we want to subset and use. Note that the minimum count will need to be lowered (if used at all) as the size of the dataset is now a fraction of what is was when we considered all the documents (not just those from a particular genre).</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_tokens</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">tokens_subset</span><span class="op">(</span><span class="va">genre</span> <span class="op">==</span> <span class="st">"pop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">textstat_collocations</span><span class="op">(</span>min_count <span class="op">=</span> <span class="fl">10</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="co">#&gt;        collocation count count_nested length lambda    z</span>
<span class="co">#&gt; 1         of you i    12            0      3   6.85 6.35</span>
<span class="co">#&gt; 2     i just can't    16            0      3   5.98 4.80</span>
<span class="co">#&gt; 3         cry me a    27            0      3   8.81 4.03</span>
<span class="co">#&gt; 4        up on you    10            0      3   4.01 4.00</span>
<span class="co">#&gt; 5        is not my    17            0      3   7.11 3.84</span>
<span class="co">#&gt; 6    you know that    19            0      3   2.71 3.77</span>
<span class="co">#&gt; 7   don't stop the    25            0      3   7.01 3.76</span>
<span class="co">#&gt; 8   know just just    14            0      3   7.55 3.61</span>
<span class="co">#&gt; 9       you and me    11            0      3   5.16 3.44</span>
<span class="co">#&gt; 10  just just what    14            0      3   7.14 3.43</span>
<span class="co">#&gt; 11  don't you like    13            0      3   5.16 3.42</span>
<span class="co">#&gt; 12    are you okay    40            0      3   6.98 3.37</span>
<span class="co">#&gt; 13     just like a    27            0      3   5.58 3.35</span>
<span class="co">#&gt; 14 where you gonna    27            0      3   5.90 3.30</span>
<span class="co">#&gt; 15    i'm not your    10            0      3   6.80 3.28</span>
<span class="co">#&gt; 16        my no he    10            0      3   7.85 3.16</span>
<span class="co">#&gt; 17        me and i    10            0      3   2.45 3.15</span>
<span class="co">#&gt; 18   don't call my    18            0      3   6.36 3.09</span>
<span class="co">#&gt; 19   gonna be okay    10            0      3   7.59 3.06</span>
<span class="co">#&gt; 20    this my shit    33            0      3   7.46 3.00</span>
<span class="co">#&gt; 21  dance gonna be    10            0      3   7.28 2.94</span>
<span class="co">#&gt; 22  because of you    14            0      3   6.19 2.90</span>
<span class="co">#&gt; 23   just what you    14            0      3   2.94 2.90</span>
<span class="co">#&gt; 24   for your call    11            0      3   5.97 2.84</span>
<span class="co">#&gt; 25      am the one    12            0      3   6.05 2.84</span></code></pre></div>
<p>In this section we have covered some common strategies for doing exploration with descriptive analysis methods. These methods can be extended and combined to dig into and uncover patterns as the research and intermediate findings dictate.</p>
</div>
</div>
<div id="unsupervised-learning" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Unsupervised learning<a class="anchor" aria-label="anchor" href="#unsupervised-learning"><i class="fas fa-link"></i></a>
</h2>
<p>We now turn our attention to a second group of methods for conducting exploratory analyses –unsupervised learning.</p>
<ul>
<li>Clustering
<ul>
<li><code>textstat_dist()</code></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span>

<span class="va">lastfm_clust</span> <span class="op">&lt;-</span> <span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">dfm_weight</span><span class="op">(</span>scheme <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">textstat_dist</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"ward.D2"</span><span class="op">)</span>

<span class="va">lastfm_clust</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_dend.html">fviz_dend</a></span><span class="op">(</span>show_labels <span class="op">=</span> <span class="cn">FALSE</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-32-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_clust</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_dend.html">fviz_dend</a></span><span class="op">(</span>show_labels <span class="op">=</span> <span class="cn">FALSE</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11-exploration_files/figure-html/unnamed-chunk-33-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="va">lastfm_clust</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"document"</span><span class="op">)</span>

<span class="va">clusters</span>
<span class="co">#&gt; # A tibble: 155 × 2</span>
<span class="co">#&gt;    document value</span>
<span class="co">#&gt;    &lt;chr&gt;    &lt;int&gt;</span>
<span class="co">#&gt;  1 text1        1</span>
<span class="co">#&gt;  2 text2        2</span>
<span class="co">#&gt;  3 text3        2</span>
<span class="co">#&gt;  4 text4        1</span>
<span class="co">#&gt;  5 text5        1</span>
<span class="co">#&gt;  6 text6        2</span>
<span class="co">#&gt;  7 text7        3</span>
<span class="co">#&gt;  8 text8        2</span>
<span class="co">#&gt;  9 text9        1</span>
<span class="co">#&gt; 10 text10       1</span>
<span class="co">#&gt; # … with 145 more rows</span></code></pre></div>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">docvars</span><span class="op">(</span><span class="va">lastfm_dfm</span>, field <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">clusters</span><span class="op">$</span><span class="va">value</span>
<span class="va">lastfm_dfm</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="va">clusters</span><span class="op">$</span><span class="va">value</span>

<span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="va">docvars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="va">head</span>
<span class="co">#&gt;             artist                song   genre cluster</span>
<span class="co">#&gt; 1     Alan Jackson        Little Bitty country       1</span>
<span class="co">#&gt; 2     Alan Jackson       Remember When country       2</span>
<span class="co">#&gt; 3     Brad Paisley    Mud on the Tires country       2</span>
<span class="co">#&gt; 4 Carrie Underwood    Before He Cheats country       1</span>
<span class="co">#&gt; 5   Dierks Bentley What Was I Thinkin' country       1</span>
<span class="co">#&gt; 6     Dolly Parton              9 to 5 country       2</span></code></pre></div>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lastfm_dfm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">docvars</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">genre</span>, <span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_totals.html">adorn_totals</a></span><span class="op">(</span>where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"col"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_percentages.html">adorn_percentages</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_pct_formatting.html">adorn_pct_formatting</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;    genre     1     2     3  Total</span>
<span class="co">#&gt;  country 47.7% 40.9% 11.4% 100.0%</span>
<span class="co">#&gt;  hip-hop 69.2% 19.2% 11.5% 100.0%</span>
<span class="co">#&gt;      pop 63.4% 19.5% 17.1% 100.0%</span>
<span class="co">#&gt;     rock 54.5% 31.8% 13.6% 100.0%</span>
<span class="co">#&gt;    Total 57.4% 29.0% 13.5% 100.0%</span></code></pre></div>
<p>Looking at the assigned clusters and the genres of the songs we see some interesting patterns. For one cluster 1 appears to have the majority of the songs, followed by cluster 2, and 3. In cluster 1 Hip hop and Pop make up the majority of the songs. In cluster 2 Country and Rock tend to dominate and in cluster 3 there is a scattering of genres.</p>
<p>Now we can approach this again with distinct linguistic unit. Where in our current clusters we used words, we could switch to bigrams and see if the results change and how they change.</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Clustering: bigram features</span></code></pre></div>
<ul>
<li>Topic modeling</li>
</ul>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># textmodel_lsa()</span></code></pre></div>
<ul>
<li>Sentiment analysis</li>
</ul>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">vader</span><span class="op">)</span>  <span class="co"># sentiment analysis for micro-blogging text</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mjockers/syuzhet">syuzhet</a></span><span class="op">)</span>  <span class="co"># general sentiment analysis</span></code></pre></div>
<!-- IDEAS:



- Lastfm lyrics [coursebook]
  - Clustering -- genres or artists?
  - Keyness
  - Keyword in context
  - Collocation
  - Lexical diversity
  
- State of the Union [coursebook]
  - `quanteda.corpora::data_corpus_sotu`
    - clustering
    - topic modeling
    - collocation
      - network graph

- Tweets [Recipe]
  - US Census data and US regionalisms
  - /Users/francojc/Documents/Academic/Research/Data/_code/collect_tweets/data/original/tweets_us_regionalisms.csv

- RateMyProfessor [lab]
  - https://data.mendeley.com/datasets/fvtfjyvw7d/2
    - Clustering
    - Topic modeling

- Nativeness [coursebook]
  - CEDEL2 (Spanish)
  - Wricle and Locness (English?)
    - http://wricle.learnercorpora.com/
    - /Users/francojc/Documents/Academic/Research/Data/Language/Corpora/LOCNESS

- Love on the spectrum

- Brown Corpus
  - Clustering (document text version)
  
- ...



Get [Meditations by Marcus Aurelius](https://en.wikipedia.org/wiki/Meditations) from `gutenbergr` (`gutenberg_id == 2680`). 

- The 12 books are not believed to be in chronological order. It may be interesting to look at whether there is some book-level similarities/ differences that might suggest that some books are more similar than others. 
- A sentiment analysis would be interesting as well --do the books show similar/ different patterns in terms of sentiment?
- Topic modeling to uncover themes in the books?

-->

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="prediction-chapter.html"><span class="header-section-number">9</span> Prediction</a></div>
<div class="next"><a href="communication-overview.html">Overview</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#exploration-chapter"><span class="header-section-number">10</span> Exploration</a></li>
<li>
<a class="nav-link" href="#descriptive-analysis"><span class="header-section-number">10.1</span> Descriptive analysis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#frequency-analysis"><span class="header-section-number">10.1.1</span> Frequency analysis</a></li>
<li><a class="nav-link" href="#collocation-analysis"><span class="header-section-number">10.1.2</span> Collocation analysis</a></li>
</ul>
</li>
<li><a class="nav-link" href="#unsupervised-learning"><span class="header-section-number">10.2</span> Unsupervised learning</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/lin380/coursebook/blob/master/11-exploration.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/lin380/coursebook/edit/master/11-exploration.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Text as Data</strong>: An introduction to quantitative text analysis and reproducible research with R" was written by Jerid Francom. It was last built on May 11, 2022 (latest version).</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
